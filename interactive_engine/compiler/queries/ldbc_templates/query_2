MATCH (p:PERSON{id: $_id_})-[:KNOWS]-(friend:PERSON)<-[:HASCREATOR]-(message : POST | COMMENT) 
WHERE message.creationDate < $_date_ 
return count(p) 
