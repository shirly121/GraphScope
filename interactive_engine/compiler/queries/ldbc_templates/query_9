MATCH (person:PERSON {id: $_id_})-[:KNOWS*1..3]-(friend:PERSON)<-[:HASCREATOR]-(message)
WHERE friend <> person
	and message.creationDate < $_date_ 
RETURN count(person);
