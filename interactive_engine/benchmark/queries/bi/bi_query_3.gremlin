g.V().has("TAGCLASS", "name", "$tagClass").in("HASTYPE").in("HASTAG").dedup().as("msg").out("0..6", "REPLYOF").endV().in("CONTAINEROF").as("forum").group().by(select("forum").as("forum")).by(select("msg").count().as("msgCnt")).select("forum").out("HASMODERATOR").as("person").out("ISLOCATEDIN").out("ISPARTOF").has("COUNTRY", "name", "$country").order().by(select("msgCnt"), desc).by(select("forum").by("id"), asc).limit(20).select("forum", "msgCnt").by(valueMap("id", "title", "creationDate")).by()